{% extends 'base.html' %}
{% load static %}
{% block title %}
    {{ hospital.name }} - Needmedi.com
{% endblock %}

{% block css %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <link href="{% static 'css/details.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/cards.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/main.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/helper.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/stars.css' %}" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300&display=swap" rel="stylesheet">
{% endblock %}

{% block body %}
    {% include 'nav.html' %}
    <div class="container my-5 py-5">
        {% include 'v2/components/hospital_details_card.html' with marker=hospital id=hospital.id %}
        {% include 'v2/components/give_rating.html' %}
        {% include 'v2/components/susmodal.html' %}
    </div>

    <div class="text-center h2" id="reviews">Reviews</div>
    <div class="container mt-5">
        {% include 'v2/components/review_card.html' %}
    </div>
    <div hidden>
        {% include 'v2/components/sidebar.html' %}
    </div>
{% endblock %}

{% block script %}
    <script>

        function submitReview() {
            let affordability = $('input[name="affordability"]:checked').val() | 0
            let oxygenCare = $('input[name="oxygen-care"]:checked').val() | 0
            let conv = $('input[name="conv-care"]:checked').val() | 0
            let covidCare = $('input[name="covid-care-quality"]:checked').val() | 0
            let ventAvail = $('#Ventilator').val()
            let oxygenAvail = $('#Oxygen').val()
            let icuAvail = $('#ICU').val()
            let avgCost = $('#avgcost').val()
            let bedsAvail = $('#Bed').val()
            let comment = $('#textarea').val()
            let size = $('#size').val()
            let today = new Date().toLocaleDateString()
            console.log(conv)
            Review.create({
                financial_rating: affordability,
                avg_cost: avgCost,
                covid_rating: covidCare,
                care_rating: conv,
                oxygen_rating: oxygenCare,
                beds_available: bedsAvail,
                ventilator_availability: ventAvail,
                oxygen_availability: oxygenAvail,
                icu_availability: icuAvail,
                comment: comment,
                datef: today,
                size: size,
                marker:{{ hospital.id }}
            }).then(function (reviewobject) {
                console.log(reviewobject)
                $('#exampleModalLong').modal('toggle');
                addToast("Review Added", "Thank you for your valuable feedback!")
            }).catch(function (error) {
                const detail = error.detail
                console.log(detail)
                var current_path;
                if ('Authentication credentials were not provided.' === detail) {
                    current_path = window.location.pathname
                    window.location.href = '/login?next=' + current_path
                    addToast("Failed to Add Review", "Please Sign in to submit Reviews")


                } else if (detail) {
                    $('#exampleModalLong').modal('toggle');
                    addToast("Failed to Add Review", detail)
                } else {
                    addToast("Failed to Add Review", "Please Enter the Highlighted Values")

                }

            })
        }

        function submitSus() {
            let comment = $('#sustextarea').val()
            Sus.create({comment: comment, marker:{{ hospital.id }}}).then(function (reviewobject) {
                $('#susmodal').modal('toggle');
                addToast("Submitted", "Thank you for your valuable feedback")
            }).catch(function (error) {
                const detail = error.detail
                console.log(detail)
                var current_path;
                if ('Authentication credentials were not provided.' === detail) {
                    current_path = window.location.pathname
                    window.location.href = '/login?next=' + current_path
                    addToast("Failed to Submit", "Feedback wasnt submitted :(")

                } else {
                    addToast("Failed to Submit", "Feedback wasnt submitted :(")

                }
            })
        }
        {% if open_review %}
            window.onload = function (event) {
                $('#exampleModalLong').modal('toggle');
            }
        {% endif %}
    </script>
{% endblock %}
set OIDC_RSA_PRIVATE_KEY='MIIEowIBAAKCAQEAlm1UAK908yHLuAoKgIxkNJBRdTrym3K4bAMhuskOtyHVnbpuNwh8Yr0zc1v6DOtn4vdmIjbJBX/U2z2kxm0kIePaIR2DKjtERTLdtgs8m5SLTIPkYOWkVGTWcJ130GOYNQ9pHMpTnmHu7z+fmz6uWvFueYpQQWkIklaAzrAxRVaDWzFBpF0rfzGC2OxARQkT2wENYNzQv8T9TLh4nuoAdr8GnF+fZqk/b97TVnEKYVDjwoxSq2TfpahtyAnLw2d0BJlVihSIHNkRAF3hqDcepDJXrQAodycNOS8/lUJIOmMuBovionxo4W5SMVXr6yo9squJR37OKDlqCFlC8qBKzwIDAQABAoIBABWpvPU0T2VMMqhYWdbVYQDo37JAQPv9820qrkrV9ZaN+tNyK7klMbSOhsBQOJxvslBPTJgUx7JRDHheUkJ5KUDwLVOjimYkjtpgTumOiLXnGIB2ZgdGSvoUY4VoR/7suNi7VWneAVjHxb8SrIuQ5U8Xgc9jCdfBpohciMQ7P306lbvy2d7DBr7WXGCcKZRq29/zTGYxmF3cw+CP7OVbyZoPdU5Yda7A4hxUuxZGuy/aG2bUMT2iH5i+424oKd86h0hHWVCX9DAv9oeBXpikNc2hPr30wmiYwnAJylnf81Fb+pU02xe5bvHfz4FvwkwN46zbLQhjHW/Gm0Egj5WuRzECgYEAwHhec7BTYcMmbvdXejM8ldGsGQ3nQ46a9hZ3qNDZNSx3YlLIZlt9Vr8Z93loiVsY1Ms4zFY5hTuVFQQ3bU6aT5QvpfDpvdlrL+Iy9LnIThBUFvo5MK12VokePlw7qcmofrJCaiQpFU2aiHe4mc9nvESOFloeB7s81qWiaqOlQZMCgYEAyBRWMzEm/LtqoY17G+AYUv7GmJpnrP8duIPjdts6wbE3HPEr6wBAjeY8RrTJGgtWZ13CTIIaxiD9Q0EJ+SLSEKuwi73ODsaZQkq1a35VQGOBCxFmjtV8HlXmFVuuwf31OIvoP63jLRRgXQfqXHma6UvcaFxQEj3J/Ogd89w/h1UCgYBhoy5XBdXmvDbdCACKbz+GyQzC0PjGnqsht5gQPZJSlTIi4NfkhPj6botfrWlIdLwOBuHTVtJrMiSYusDbZIqHYCcjySjqNEdZzSgIWc6xOztNRLaKaRSlJX4AKI3jvfcJ/qgObDWjJvED1agB7uMy8Jwb3q9pQKTGRtQzwLxunQKBgBipWQ6qSlHwj+4l0DzZXGYufTAmKA1MzM8HgqwNzao+O7rXh0BKIarb7CYS9o69QwMurVpc1wwA2PbHN4F750SixPoUhSeRFybyqnX7dmqfWTKSDIAilE/w6pFLYbkLooQ7yn6+4jeWQWJ2LU8EtjF3Zk1+w2fcMd94hOigBzyZAoGBAJC2ulBElzxqH0T0vSDa2xZwajEGo1gV71BpXZOEGWawcrTaiYczzEDv+v6Xspg3RlQ/w4rT/qrAXAWdsLdJC7NjXJYfgxtZiYrpEi3Zs54ISozMqeqAfJR8L5NwOyVe3S4sx3yzJbAR96Z17SRn078ZGDy+LimN3iZGPRDI0s6i'